{
  "ServerRole": "WebServer",
  "Description": "Firewall rules for IIS Web Servers",
  "CreatedDate": "2025-12-26",
  "CISBenchmark": "Windows Server 2022 v2.0.0",
  "Prerequisites": [
    "Apply CIS_Domain_Profile_Rules.json first for core management",
    "Ensure IIS is installed and configured",
    "Update RemoteAddress fields if restricting to specific networks",
    "Enable HTTPS and disable HTTP for production systems"
  ],
  "Rules": [
    {
      "DisplayName": "CIS-FW-WEB-001: HTTP",
      "Description": "Hypertext Transfer Protocol (unencrypted)",
      "Direction": "Inbound",
      "Action": "Allow",
      "Protocol": "TCP",
      "LocalPort": "80",
      "RemoteAddress": "",
      "Profile": "Domain,Private,Public",
      "Group": "Web Server",
      "Enabled": false,
      "Notes": "Disabled by default - use HTTPS instead. Enable only if HTTP-to-HTTPS redirect is configured or for specific requirements"
    },
    {
      "DisplayName": "CIS-FW-WEB-002: HTTPS",
      "Description": "Hypertext Transfer Protocol Secure (SSL/TLS)",
      "Direction": "Inbound",
      "Action": "Allow",
      "Protocol": "TCP",
      "LocalPort": "443",
      "RemoteAddress": "",
      "Profile": "Domain,Private,Public",
      "Group": "Web Server",
      "Enabled": true
    },
    {
      "DisplayName": "CIS-FW-WEB-003: FTP Control",
      "Description": "File Transfer Protocol control channel",
      "Direction": "Inbound",
      "Action": "Allow",
      "Protocol": "TCP",
      "LocalPort": "21",
      "RemoteAddress": "",
      "Profile": "Domain",
      "Group": "FTP Server",
      "Enabled": false,
      "Notes": "Disabled by default - FTP is insecure. Use SFTP/FTPS instead if file transfer needed"
    },
    {
      "DisplayName": "CIS-FW-WEB-004: FTPS Data (Implicit SSL)",
      "Description": "FTPS data channel with implicit SSL (port 990)",
      "Direction": "Inbound",
      "Action": "Allow",
      "Protocol": "TCP",
      "LocalPort": "990",
      "RemoteAddress": "",
      "Profile": "Domain",
      "Group": "FTP Server",
      "Enabled": false,
      "Notes": "Enable if using FTPS instead of plain FTP"
    },
    {
      "DisplayName": "CIS-FW-WEB-005: FTP Passive Mode",
      "Description": "FTP passive mode data channel (high ports)",
      "Direction": "Inbound",
      "Action": "Allow",
      "Protocol": "TCP",
      "LocalPort": "49152-65535",
      "RemoteAddress": "",
      "Profile": "Domain",
      "Group": "FTP Server",
      "Enabled": false,
      "Notes": "Only if FTP passive mode is required. Consider restricting to smaller range like 50000-51000"
    },
    {
      "DisplayName": "CIS-FW-WEB-006: Web Management Service",
      "Description": "IIS Web Management Service for remote administration",
      "Direction": "Inbound",
      "Action": "Allow",
      "Protocol": "TCP",
      "LocalPort": "8172",
      "RemoteAddress": "10.0.1.0/24",
      "Profile": "Domain",
      "Group": "Web Server",
      "Enabled": false,
      "Notes": "Enable if using Web Management Service (WMSvc) for remote IIS management. Restrict to admin subnet."
    },
    {
      "DisplayName": "CIS-FW-WEB-007: WebSocket Secure",
      "Description": "WebSocket Secure protocol (uses HTTPS)",
      "Direction": "Inbound",
      "Action": "Allow",
      "Protocol": "TCP",
      "LocalPort": "443",
      "RemoteAddress": "",
      "Profile": "Domain,Private,Public",
      "Group": "Web Server",
      "Enabled": true,
      "Notes": "Uses same port as HTTPS (443). Included for documentation. Enable CIS-FW-WEB-002"
    },
    {
      "DisplayName": "CIS-FW-WEB-008: HTTP Alternate Port",
      "Description": "Alternate HTTP port (often used for testing/dev)",
      "Direction": "Inbound",
      "Action": "Allow",
      "Protocol": "TCP",
      "LocalPort": "8080",
      "RemoteAddress": "",
      "Profile": "Domain",
      "Group": "Web Server",
      "Enabled": false,
      "Notes": "Only enable if application requires alternate port. Not recommended for production."
    },
    {
      "DisplayName": "CIS-FW-WEB-009: HTTPS Alternate Port",
      "Description": "Alternate HTTPS port (often used for admin interfaces)",
      "Direction": "Inbound",
      "Action": "Allow",
      "Protocol": "TCP",
      "LocalPort": "8443",
      "RemoteAddress": "10.0.1.0/24",
      "Profile": "Domain",
      "Group": "Web Server",
      "Enabled": false,
      "Notes": "Enable if admin/management interface runs on alternate HTTPS port. Restrict to admin subnet."
    },
    {
      "DisplayName": "CIS-FW-WEB-010: HTTP Outbound (Proxy/API)",
      "Description": "Allow outbound HTTP for proxying or API calls",
      "Direction": "Outbound",
      "Action": "Allow",
      "Protocol": "TCP",
      "RemotePort": "80",
      "RemoteAddress": "",
      "Profile": "Domain,Private,Public",
      "Group": "Web Server",
      "Enabled": false,
      "Notes": "Enable if web server acts as reverse proxy or calls external HTTP APIs"
    },
    {
      "DisplayName": "CIS-FW-WEB-011: HTTPS Outbound (Proxy/API)",
      "Description": "Allow outbound HTTPS for proxying or API calls",
      "Direction": "Outbound",
      "Action": "Allow",
      "Protocol": "TCP",
      "RemotePort": "443",
      "RemoteAddress": "",
      "Profile": "Domain,Private,Public",
      "Group": "Web Server",
      "Enabled": false,
      "Notes": "Enable if web server acts as reverse proxy or calls external HTTPS APIs"
    }
  ],
  "SecurityRecommendations": [
    "Always use HTTPS (443) in production - disable HTTP (80) unless redirecting to HTTPS",
    "Avoid FTP - use SFTP or FTPS if file transfer is required",
    "Restrict Web Management Service (8172) to admin subnet only",
    "Use valid SSL/TLS certificates from trusted CA",
    "Configure IIS to use TLS 1.2 or higher - disable SSLv3, TLS 1.0, TLS 1.1",
    "Enable IIS logging and forward logs to SIEM",
    "Implement request filtering and rate limiting in IIS",
    "Use WAF (Web Application Firewall) for public-facing sites",
    "Regular patching of IIS and .NET Framework",
    "Principle of least privilege for IIS application pools"
  ],
  "CommonApplicationPorts": {
    "HTTP": 80,
    "HTTPS": 443,
    "HTTP_Alt": 8080,
    "HTTPS_Alt": 8443,
    "FTP": 21,
    "FTPS_Implicit": 990,
    "FTPS_Explicit": 21,
    "Web_Management": 8172,
    "WebSocket": 443,
    "SignalR": 443
  }
}
